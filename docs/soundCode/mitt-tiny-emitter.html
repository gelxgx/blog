<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>
      ã€æºç è®¡åˆ’ç¬¬ä¸ƒæœŸã€‘mittã€tiny-emitter å‘å¸ƒè®¢é˜… | ç˜¦è™
    </title>
    <meta name="description" content="A VitePress site">
    <link rel="stylesheet" href="/blog/_assets/style.822f840d.css">
    <link rel="modulepreload" href="/blog/_assets/common-1984dd55.js">
    <link rel="modulepreload" href="/blog/_assets/docs_soundCode_mitt-tiny-emitter.md.764ec47d.lean.js">
    <link rel="modulepreload" href="/blog/_assets/app.9e239910.js">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <meta name="keywords" content="ç˜¦è™">
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="https://lib.baomitu.com/gitalk/1.7.0/gitalk.min.css">
    <script src="https://lib.baomitu.com/gitalk/1.7.0/gitalk.min.js"></script>
    <script src="https://lib.baomitu.com/axios/0.21.1/axios.js"></script>
    
  </head>
  <body>
    <div id="app"><!--[--><div id="containerColor" class="no-sidebar theme" data-v-1eb0b654><header class="navbar" data-v-1eb0b654><!--[--><a class="title" aria-label="ç˜¦è™, back to home" href="/blog/"><img class="logo" src="/blog/favicon.ico" alt="logo"><span>ç˜¦è™</span></a><div class="flex-grow"></div><nav class="nav-links hide-mobile"><!--[--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/index.html" target="" rel="">ğŸ  é¦–é¡µ<!-- <OutboundLink v-if="isExternalLink" /> --></a></div><!--]--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/more/docs.html" target="" rel="">ğŸ“… å½’æ¡£<!-- <OutboundLink v-if="isExternalLink" /> --></a></div><!--]--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/more/tags.html" target="" rel="">ğŸ“‚ åˆ†ç±»<!-- <OutboundLink v-if="isExternalLink" /> --></a></div><!--]--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/more/Friendship.html" target="" rel="">ğŸ‘« å‹æƒ…é“¾æ¥<!-- <OutboundLink v-if="isExternalLink" /> --></a></div><!--]--><!--]--><!----><!----></nav><!--[--><!--]--><!--]--><div class="sidebar-button" data-v-1eb0b654><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div></header><aside class="" data-v-1eb0b654><!--[--><nav class="nav-links show-mobile"><!--[--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/index.html" target="" rel="">ğŸ  é¦–é¡µ<!-- <OutboundLink v-if="isExternalLink" /> --></a></div><!--]--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/more/docs.html" target="" rel="">ğŸ“… å½’æ¡£<!-- <OutboundLink v-if="isExternalLink" /> --></a></div><!--]--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/more/tags.html" target="" rel="">ğŸ“‚ åˆ†ç±»<!-- <OutboundLink v-if="isExternalLink" /> --></a></div><!--]--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/more/Friendship.html" target="" rel="">ğŸ‘« å‹æƒ…é“¾æ¥<!-- <OutboundLink v-if="isExternalLink" /> --></a></div><!--]--><!--]--><!----><!----></nav><!--[--><!--]--><ul class="sidebar"><!--[--><!--]--></ul><!--[--><!--]--><!--]--></aside><!----><!-- TODO: make this button accessible --><div class="sidebar-mask" data-v-1eb0b654></div><main data-v-1eb0b654><!--[--><div class="content"><!--[--><!--]--><div class="md-header"><div class="md-title">ã€æºç è®¡åˆ’ç¬¬ä¸ƒæœŸã€‘mittã€tiny-emitter å‘å¸ƒè®¢é˜…</div><span id="jinrishici-sentence">æ­£åœ¨åŠ è½½ä»Šæ—¥è¯—è¯....</span><div class="md-date">2021-11-30</div></div><ul class="catalog"><!--[--><li class="catalog-item"><!----><a class="level level-3" href="#_1-é˜…è¯»å‰å‡†å¤‡">1.é˜…è¯»å‰å‡†å¤‡</a></li><li class="catalog-item"><!----><a class="level level-3" href="#_2-å¼€å§‹é˜…è¯»">2.å¼€å§‹é˜…è¯»</a></li><li class="catalog-item"><!----><a class="level level-3" href="#_3-æºç æ­£æ–‡">3.æºç æ­£æ–‡</a></li><li class="catalog-item"><!----><a class="level level-3" href="#_4-æ€»ç»“">4.æ€»ç»“</a></li><!--]--></ul><div><h3 id="_1-é˜…è¯»å‰å‡†å¤‡"><a class="header-anchor" href="#_1-é˜…è¯»å‰å‡†å¤‡" aria-hidden="true">#</a> 1.é˜…è¯»å‰å‡†å¤‡</h3><p>è¿™ä¸¤ä¸ªåº“éƒ½æ˜¯åœ¨vueä¸­éå¸¸ç†Ÿæ‚‰ã€ä½¿ç”¨é¢‘ç‡å¾ˆé«˜çš„äº‹ä»¶ä¼ é€’æ–¹æ³•ä¹‹ä¸€ï¼Œè€ŒVue3.xç‰ˆæœ¬ç§»é™¤äº†å†…ç½®çš„$onã€$offçš„æ–¹æ³•ï¼Œæ”¹ç”¨ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“è¿›è¡Œè¯¥æ–¹æ³•çš„è°ƒç”¨</p><p>é˜…è¯»å‰å…ˆæ¸©ä¹ ä¸€ä¸‹æ­£å¸¸çš„ä½¿ç”¨æ–¹æ³•ï¼š</p><h4 id="_1-1-ä½¿ç”¨æ–¹æ³•"><a class="header-anchor" href="#_1-1-ä½¿ç”¨æ–¹æ³•" aria-hidden="true">#</a> 1.1 ä½¿ç”¨æ–¹æ³•</h4><p>é¦–å…ˆ <strong>$onå’Œ$emitçš„äº‹ä»¶å¿…é¡»åœ¨ä¸€ä¸ªå…¬å…±å®ä¾‹ä¸Šæ‰ä¼šè¢«è§¦å‘</strong> ã€‚</p><p>åœ¨vueé¡¹ç›®å¼€å‘æ—¶ï¼Œç»å¸¸ä¼šé‡åˆ°å…„å¼Ÿã€çˆ·å­™ç»„ä»¶çš„ä¼ å€¼æƒ…å†µï¼Œæ­¤æ—¶é€šå¸¸ä¼šä½¿ç”¨Vueå®ä¾‹ä½œä¸ºä¸­å¤®äº‹ä»¶å¤„ç†æ€»çº¿ï¼Œå°†äº‹ä»¶æ”¾ç½®åœ¨å…¨å±€ä¸­è§¦å‘</p><div class="language-"><pre><code>vue.prototype.$bus = new Vue();

this.$bus.$emit(&#39;test&#39;,&#39;gelx&#39;)

// mountedä¸­æ¥å—å‡½æ•°
mounted() {
	this.$bus.$on(&#39;test&#39;,info =&gt; {
    console.log(info)
  })
}
</code></pre></div><h4 id="_1-2-ç®€å•äº†è§£map"><a class="header-anchor" href="#_1-2-ç®€å•äº†è§£map" aria-hidden="true">#</a> 1.2 ç®€å•äº†è§£Map</h4><p>æºç ä¸­å¤§é‡ä½¿ç”¨çš„Mapçš„æ–¹æ³•ï¼Œç”±äºä¹‹å‰æ²¡æœ‰æ¥è§¦è¿‡Mapï¼Œå› æ­¤åšä¸€ä¸ªå°å°çš„é¢„ä¹ </p><h5 id="_1-2-1-ä»€ä¹ˆæ˜¯map"><a class="header-anchor" href="#_1-2-1-ä»€ä¹ˆæ˜¯map" aria-hidden="true">#</a> 1.2.1 ä»€ä¹ˆæ˜¯map</h5><p>Mapå¯¹è±¡ä¿å­˜é”®/å€¼ å¯¹ï¼Œæ˜¯é”®/å€¼å¯¹çš„é›†åˆ</p><h5 id="_1-2-2ä¸objectå¯¹è±¡çš„ä¸åŒç‚¹"><a class="header-anchor" href="#_1-2-2ä¸objectå¯¹è±¡çš„ä¸åŒç‚¹" aria-hidden="true">#</a> 1.2.2ä¸Objectå¯¹è±¡çš„ä¸åŒç‚¹</h5><ul><li><p>Mapçš„é”®å¯ä»¥æ˜¯ä»»æ„å€¼</p></li><li><p>Mapçš„é”®å€¼æ˜¯æœ‰é¡ºåºçš„ï¼Œéå†æ—¶ä¼šæŒ‰æ’å…¥çš„é¡ºåºè¿”å›é”®å€¼</p></li><li><p>é€šè¿‡sizeå±æ€§å¯ä»¥è·å–Mapçš„é”®å€¼å¯¹ä¸ªæ•°</p></li><li><p>Mapå¯ä»¥è¿›è¡Œè¿­ä»£</p></li></ul><h5 id="_1-2-3å¸¸ç”¨çš„å±æ€§ã€æ–¹æ³•"><a class="header-anchor" href="#_1-2-3å¸¸ç”¨çš„å±æ€§ã€æ–¹æ³•" aria-hidden="true">#</a> 1.2.3å¸¸ç”¨çš„å±æ€§ã€æ–¹æ³•</h5><ul><li><p>å±æ€§</p></li><li><ul><li>size è·å–é”®å€¼å¯¹æ•°é‡</li></ul></li><li><p>æ–¹æ³•</p></li><li><ul><li>clear() æ¸…ç©ºmapå¯¹è±¡</li><li>delete(key) ç§»é™¤æŸä¸ªæŒ‡å®šå…ƒç´ </li></ul></li><li><ul><li>get(key) è¿”å›æŸä¸ªæŒ‡å®šå…ƒç´ </li><li>has(key) æ£€æµ‹æ˜¯å¦å­˜åœ¨æŸä¸ªå…ƒç´ </li></ul></li><li><ul><li>set(key,value) æ·»åŠ è‡³Mapå¯¹è±¡çš„key é”®å’Œå¯¹åº”çš„value å€¼</li></ul></li></ul><h3 id="_2-å¼€å§‹é˜…è¯»"><a class="header-anchor" href="#_2-å¼€å§‹é˜…è¯»" aria-hidden="true">#</a> 2.å¼€å§‹é˜…è¯»</h3><p>ä»Šå¤©ä¸»è¦æœ‰ä¸¤éƒ¨åˆ†æºç </p><p>ç¬¬ä¸€éƒ¨åˆ†mitt: <a href="https://github.com/developit/mitt" target="_blank" rel="noopener noreferrer">https://github.com/developit/mitt</a></p><p>ç¬¬äºŒéƒ¨åˆ†tiny-emitter: <a href="https://github.com/scottcorgan/tiny-emitter" target="_blank" rel="noopener noreferrer">https://github.com/scottcorgan/tiny-emitter</a></p><p>å­¦ä¹ çš„ç›®æ ‡å°±æ˜¯äº†è§£å’Œå­¦ä¹ å‘å¸ƒè®¢é˜…è€…æ¨¡å¼</p><h3 id="_3-æºç æ­£æ–‡"><a class="header-anchor" href="#_3-æºç æ­£æ–‡" aria-hidden="true">#</a> 3.æºç æ­£æ–‡</h3><h4 id="_3-1-miitæºç é˜…è¯»"><a class="header-anchor" href="#_3-1-miitæºç é˜…è¯»" aria-hidden="true">#</a> 3.1 miitæºç é˜…è¯»</h4><p>é¦–å…ˆå¼€å§‹é˜…è¯»mittæºç </p><p>å…·ä½“æºç ç›®å½•å¦‚ä¸‹ï¼Œä¸»è¦æœ‰ä¸¤éƒ¨åˆ†ï¼šæºç ä¸»ä½“ã€testæµ‹è¯•ç”¨ä¾‹</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f21b58adf35a494b95d456d71c61d1df~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p><p>ç¬¬ä¸€ä»¶äº‹ï¼Œ<code>tsc src/index.ts</code></p><p>å¸Œæœ›è‡ªå·±å¯ä»¥æ—©ç‚¹å­¦ä¼štsï¼Œè¿›è¡Œtsæºç é˜…è¯»â€¦â€¦</p><h5 id="_3-1-1-æºç ä¸»ä½“"><a class="header-anchor" href="#_3-1-1-æºç ä¸»ä½“" aria-hidden="true">#</a> 3.1.1 æºç ä¸»ä½“</h5><p>æ•´ä¸ªæºç å‡½æ•°ä¸»è¦å®ç°äº†å››ä¸ªåŠŸèƒ½ï¼š</p><p>1ï¼šæ¥æ”¶ä¸€ä¸ªå¤–æ¥å‚æ•°ï¼Œæˆ–ç›´æ¥æ–°å»ºä¸€ä¸ªMapå¯¹è±¡</p><p>2ï¼šå®ç°onå‡½æ•°</p><p>3ï¼šå®ç°offå‡½æ•°</p><p>4ï¼šå®ç°emitå‡½æ•°</p><div class="language-"><pre><code>function mitt(all) {
    all = all || new Map();
    return {
        all: all,
        on: function (type, handler) {
            // code ...
        },
        off: function (type, handler) {
            // code ...
        },
        emit: function (type, evt) {
            // code ...
        }
    };
}
</code></pre></div><h5 id="_3-1-2-on-ï¼Œå®ƒæ˜¯ä¸€ä¸ªè®¢é˜…è€…è®¢é˜…äº‹ä»¶çš„å‡½æ•°"><a class="header-anchor" href="#_3-1-2-on-ï¼Œå®ƒæ˜¯ä¸€ä¸ªè®¢é˜…è€…è®¢é˜…äº‹ä»¶çš„å‡½æ•°" aria-hidden="true">#</a> 3.1.2 on()ï¼Œå®ƒæ˜¯ä¸€ä¸ªè®¢é˜…è€…è®¢é˜…äº‹ä»¶çš„å‡½æ•°</h5><div class="language-"><pre><code>on: function (type, handler) {
  // è·å–æŒ‡å®štypeå¯¹åº”çš„handler
  var handlers = all.get(type);
  // å¦‚æœå­˜åœ¨ï¼Œå°±ä¸ºå·²æœ‰çš„å¤„ç†ä¸Špushä¸€ä¸ªæ–°çš„handler
  if (handlers) {
    handlers.push(handler);
  }
  // å¦‚æœä¸å­˜åœ¨ï¼Œå°±æ–°å¢ä¸€ä¸ªtypeï¼Œä¸”å¯¹åº”çš„å¤„ç†ç”±æ•°ç»„å­˜æ”¾ï¼Œä¸ºäº†æ–¹ä¾¿æ·»åŠ å¤šä¸ªå¤„ç†
  else {
    all.set(type, [handler]);
  }
},
</code></pre></div><h5 id="_3-1-3-off-ï¼Œå®ƒæ˜¯ä¸€ä¸ªè®¢é˜…è€…åˆ é™¤è®¢é˜…äº‹ä»¶çš„å‡½æ•°"><a class="header-anchor" href="#_3-1-3-off-ï¼Œå®ƒæ˜¯ä¸€ä¸ªè®¢é˜…è€…åˆ é™¤è®¢é˜…äº‹ä»¶çš„å‡½æ•°" aria-hidden="true">#</a> 3.1.3 off()ï¼Œå®ƒæ˜¯ä¸€ä¸ªè®¢é˜…è€…åˆ é™¤è®¢é˜…äº‹ä»¶çš„å‡½æ•°</h5><div class="language-"><pre><code>off: function (type, handler) {
  // åŒæ ·è·å–æŒ‡å®štypeçš„handler
  var handlers = all.get(type);
  // å¦‚æœä¼ å…¥äº†handler
  if (handlers) {
    // ä¸”è¿™ä¸ªtypeå­˜åœ¨æ—¶
    if (handler) {
      // ä¼šåœ¨typeä¸­å¯»æ‰¾ä¸ä¼ å…¥çš„handlerç›¸å¯¹åº”çš„handler
      // å¦‚æœå­˜åœ¨ï¼Œå°±ä¼šç›´æ¥è¿”å›åœ¨æ•°ç»„ä¸­çš„ä½ç½®ï¼Œè¿›è¡Œåˆ é™¤
      // å¦‚æœä¸å­˜åœ¨ï¼Œå°±ä¼šç›´æ¥è¿”å›åŸæ•°ç»„ï¼Œè¿™é‡Œä¸‹é¢ä¼šç»§ç»­åˆ†æ
      handlers.splice(handlers.indexOf(handler) &gt;&gt;&gt; 0, 1);
    }
    // å¦‚æœæ²¡æœ‰ä¼ å…¥handler
    // é»˜è®¤å½“å‰typeä¸‹å…¨éƒ¨æ¸…ç©º
    else {
      all.set(type, []);
    }
  }
},
</code></pre></div><p>è¿™éƒ¨åˆ†å‡ºç°äº†ä¸€ä¸ª <code>&gt;&gt;&gt; 0</code> çš„è¡¨è¾¾å¼ï¼Œè¿›ä¸€æ­¥äº†è§£è¿™ä¸ªè¡¨è¾¾å¼çš„æ„ä¹‰</p><p>jsä¸­&gt;&gt;è¡¨ç¤ºæœ‰ç¬¦å·ä½ç§»ï¼Œ&gt;&gt;&gt;è¡¨ç¤ºæ— ç¬¦å·ä½ç§»</p><ul><li>æœ‰ç¬¦å·ä½ç§»è¡¨ç¤º å³è¾¹ç§»å»ä¸€ä¸ª0ï¼Œå·¦è¾¹è¡¥å……ä¸€ä¸ª1</li><li>æ— ç¬¦å·ä½ç§»è¡¨ç¤º å³è¾¹ç§»å»ä¸€ä¸ª0ï¼Œå·¦è¾¹è¡¥å……ä¸€ä¸ª0</li></ul><p>å½“éœ€è¦æ“ä½œæ­£æ•°çš„æ—¶å€™ï¼Œæ˜¯ä¸ä¼šæœ‰å·®åˆ«çš„</p><p>ä½†æ“ä½œè´Ÿæ•°çš„æ—¶å€™ï¼Œå°±ä¼šæœ‰éå¸¸å¤§çš„å·®åˆ«</p><p>è´Ÿæ•°åœ¨äºŒè¿›åˆ¶ä¸­çš„è¡¨è¾¾æ˜¯ä»¥è¡¥ç çš„å½¢å¼å­˜åœ¨ï¼Œä¹Ÿå°±æ˜¯æ­£å¸¸çš„äºŒè¿›åˆ¶ç çš„åç å†åŠ +</p><p>è´Ÿæ•°è¿›è¡Œæ— ç¬¦å·çš„ä½ç§»æ—¶ï¼Œä¼šåœ¨å·¦è¾¹è¡¥å……ä¸€ä¸ª0ï¼Œå˜æˆäº†æ­£æ•°ï¼Œä¹Ÿå°±æ˜¯ç›®å‰æ•°ç»„çš„é•¿åº¦ï¼Œåˆ é™¤ä¸€ä¸ªæœ€å¤§é•¿åº¦ä¸Šçš„ç¬¬ä¸€ä½ï¼ˆç©ºå€¼ï¼‰ï¼Œæ‰€ä»¥è¿™éƒ¨åˆ†ä¼šå°†å†…å®¹å…¨éƒ¨è¿”å›</p><h5 id="_3-1-4-emit-ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‘å¸ƒè€…å‘å¸ƒäº‹ä»¶çš„å‡½æ•°"><a class="header-anchor" href="#_3-1-4-emit-ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‘å¸ƒè€…å‘å¸ƒäº‹ä»¶çš„å‡½æ•°" aria-hidden="true">#</a> 3.1.4 emit()ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‘å¸ƒè€…å‘å¸ƒäº‹ä»¶çš„å‡½æ•°</h5><div class="language-"><pre><code>emit: function (type, evt) {
  // è·å–æŒ‡å®štypeå¯¹åº”çš„handlers
  var handlers = all.get(type);
  // å¦‚æœå­˜åœ¨
  if (handlers) {
    // æµ…æ‹·è´handlersï¼Œå¹¶å¾ªç¯å¯¹æ‰€æœ‰handleræ‰§è¡Œå‚æ•°ä¸ºevtçš„æ–¹æ³•
    handlers
      .slice()
      .map(function (handler) {
      handler(evt);
    });
  }
  // å¦‚æœä¸å­˜åœ¨
  // æ‰¾å…¨å±€ä¸Šç»‘å®šçš„handlers
  handlers = all.get(&#39;*&#39;);
  // å¦‚æœå…¨å±€ä¸Šçº¯åœ¨handlers
  // ä¾æ¬¡è¿›è¡Œæ‰§è¡Œï¼Œå¹¶ä¼ é€’å½“å‰è§¦å‘çš„type
  if (handlers) {
    handlers
      .slice()
      .map(function (handler) {
      handler(type, evt);
    });
  }
}
</code></pre></div><p>è¿™éƒ¨åˆ†çš„emitä»…å¯ä¼ é€’ä¸€ä¸ªå‚æ•°ï¼Œå¦‚æœéœ€è¦ä¼ é€’å¤šä¸ªå‚æ•°ï¼Œéœ€è¦ä»¥å¯¹è±¡æˆ–æ•°ç»„çš„å½¢å¼ä¼ å…¥</p><h4 id="_3-2-1-tiny-emitter-éƒ¨åˆ†"><a class="header-anchor" href="#_3-2-1-tiny-emitter-éƒ¨åˆ†" aria-hidden="true">#</a> 3.2.1 tiny-emitter éƒ¨åˆ†</h4><p>è¿™ä¸ªå·¥å…·åº“å®ç°çš„åŠŸèƒ½ä¸mittå¤§åŒå°å¼‚ï¼ŒåŒæ ·å®ç°äº†<code>$on $once $off $emit</code>çš„åŠŸèƒ½ï¼Œä½†å…·ä½“çš„ä½¿ç”¨ä¸Šä¼šæœ‰ä¸€äº›å°çš„å·®å¼‚</p><h5 id="_3-2-2-ä½¿ç”¨æ–¹å¼"><a class="header-anchor" href="#_3-2-2-ä½¿ç”¨æ–¹å¼" aria-hidden="true">#</a> 3.2.2 ä½¿ç”¨æ–¹å¼</h5><p>å…ˆçœ‹çœ‹å®˜æ–¹æ–‡æ¡£ç»™å‡ºçš„ä½¿ç”¨æ¡ˆä¾‹ï¼š</p><div class="language-"><pre><code>var Emitter = require(&#39;tiny-emitter&#39;);
var emitter = new Emitter();

emitter.on(&#39;some-event&#39;, function (arg1, arg2, arg3) {
 //
});

emitter.emit(&#39;some-event&#39;, &#39;arg1 value&#39;, &#39;arg2 value&#39;, &#39;arg3 value&#39;);
</code></pre></div><p>ä»è¿™é‡Œå°±å¯ä»¥çœ‹åˆ°ä¸miitä¸€ä¸ªæ¯”è¾ƒå¤§çš„ä¸åŒæ˜¯ï¼šemitå¯ä»¥ä¼ é€’å¤šä¸ªå‚æ•°</p><h5 id="_3-2-3-æºç é˜…è¯»"><a class="header-anchor" href="#_3-2-3-æºç é˜…è¯»" aria-hidden="true">#</a> 3.2.3 æºç é˜…è¯»</h5><p>\</p><p>é¦–å…ˆä¾æ—§æ˜¯<code>tsc index.d.ts</code></p><p>è¿™ä¸ªåº“æ˜¯å®šä¹‰äº†ä¸€ä¸ªç©ºçš„å‡½æ•°ï¼Œé€šè¿‡åœ¨å®ƒçš„åŸå‹ä¸Šå®šä¹‰äº†4ç§æ–¹æ³•ï¼š</p><ul><li>on()</li><li>once()</li></ul><!----><ul><li>emit()</li><li>off()</li></ul><div class="language-"><pre><code>function E () {
  // Keep this empty so it&#39;s easier to inherit from
  // (via https://github.com/lipsmack from https://github.com/scottcorgan/tiny-emitter/issues/3)
}

E.prototype = {
  on: function (name, callback, ctx) {
    //code...
  },

  once: function (name, callback, ctx) {
    //code...
  },

  emit: function (name) {
    // code...
  },

  off: function (name, callback) {
    // code...
  }
};
</code></pre></div><h5 id="_3-2-4-on-è®¢é˜…äº‹ä»¶"><a class="header-anchor" href="#_3-2-4-on-è®¢é˜…äº‹ä»¶" aria-hidden="true">#</a> 3.2.4 on() è®¢é˜…äº‹ä»¶</h5><div class="language-"><pre><code>on: function (name, callback, ctx) {
  	// åˆ¤æ–­æ˜¯å¦å­˜åœ¨e,å¦‚æœä¸å­˜åœ¨ï¼Œå°±æ˜¯ç”¨ç©ºå¯¹è±¡ 
  	// mittæ˜¯ç”¨çš„æ˜¯Map
    var e = this.e || (this.e = {});
  	// å¹¶åˆ¤æ–­ä¼ å…¥çš„nameæ˜¯å¦å­˜åœ¨ï¼Œç”¨æ•°ç»„çš„æ–¹å¼å­˜å‚¨
    (e[name] || (e[name] = [])).push({
      fn: callback,
      ctx: ctx
    });
		// è¿”å›thisï¼Œä¿æŒä¸Šä¸‹æ–‡ä¾æ—§å¯ä»¥è°ƒç”¨
    return this;
  },
</code></pre></div><h5 id="once-åªæ‰§è¡Œä¸€æ¬¡è®¢é˜…æ—¶é—´"><a class="header-anchor" href="#once-åªæ‰§è¡Œä¸€æ¬¡è®¢é˜…æ—¶é—´" aria-hidden="true">#</a> once() åªæ‰§è¡Œä¸€æ¬¡è®¢é˜…æ—¶é—´</h5><div class="language-"><pre><code>once: function (name, callback, ctx) {
    var self = this;
    function listener () {
      // æ‰§è¡Œå®Œæˆåè°ƒç”¨offæ³¨é”€äº‹ä»¶
      self.off(name, listener);
      callback.apply(ctx, arguments);
    };

    listener._ = callback
    return this.on(name, listener, ctx);
  },
</code></pre></div><h5 id="emit-å‘å¸ƒäº‹ä»¶"><a class="header-anchor" href="#emit-å‘å¸ƒäº‹ä»¶" aria-hidden="true">#</a> emit() å‘å¸ƒäº‹ä»¶</h5><div class="language-"><pre><code>emit: function (name) {
  // åˆ›å»ºä¸€ä¸ªdataæ•°ç»„ï¼Œå¹¶è·å–å‚æ•°ï¼Œè¿™é‡Œå¯ä»¥æ‹¿åˆ°å¤šä¸ªå‚æ•°
  var data = [].slice.call(arguments, 1);
  var evtArr = ((this.e || (this.e = {}))[name] || []).slice();
  var i = 0;
  var len = evtArr.length;

  for (i; i &lt; len; i++) {
    // éå†æ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œå¹¶æ¥æ”¶ä¼ å…¥çš„dataå‚æ•°
    evtArr[i].fn.apply(evtArr[i].ctx, data);
  }

  return this;
},
</code></pre></div><h5 id="off-å–æ¶ˆäº‹ä»¶ç»‘å®š"><a class="header-anchor" href="#off-å–æ¶ˆäº‹ä»¶ç»‘å®š" aria-hidden="true">#</a> off() å–æ¶ˆäº‹ä»¶ç»‘å®š</h5><div class="language-"><pre><code>off: function (name, callback) {
    var e = this.e || (this.e = {});
  	// è·å–eä¸Šnameä¸­å¯¹åº”çš„æ‰€æœ‰çš„å›è°ƒå‡½æ•°
    var evts = e[name];
    var liveEvents = [];
		// å¦‚æœoffä¼ å…¥äº†å›è°ƒå‡½æ•°
    if (evts &amp;&amp; callback) {
      // ä¼šéå†nameä¸­æ‰€æœ‰çš„å‡½æ•°
      for (var i = 0, len = evts.length; i &lt; len; i++) {
        	// å¦‚æœå­˜åœ¨ä¸ä¼ å…¥çš„å›è°ƒå‡½æ•°ä¸åŒçš„å‡½æ•°ï¼Œå°±pushè¿›æ•°ç»„ä¸­
        if (evts[i].fn !== callback &amp;&amp; evts[i].fn._ !== callback)
          liveEvents.push(evts[i]);
      }
    }
  	// æœ€åå¦‚æœè¿™ä¸ªæ•°ç»„å­˜åœ¨å†…å®¹ï¼Œå°±ä¿ç•™ç»§ç»­æ‰§è¡Œï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå°±æ•´ä¸ªåˆ æ‰
    (liveEvents.length)
      ? e[name] = liveEvents
      : delete e[name];

    return this;
  }
</code></pre></div><h3 id="_4-æ€»ç»“"><a class="header-anchor" href="#_4-æ€»ç»“" aria-hidden="true">#</a> 4.æ€»ç»“</h3><p>é€šè¿‡é˜…è¯»è¿™ä¸¤ä¸ªå¼€æºåº“ä¹Ÿå­¦åˆ°äº†ï¼š</p><ul><li><p>Mapçš„å…·ä½“ç”¨æ³•ï¼Œä¸Objectçš„å¼‚åŒç‚¹</p></li><li><p>å‘å¸ƒè®¢é˜…çš„è®¾è®¡æ¨¡å¼</p></li><li><p>äº‹ä»¶ä¼ é€’çš„åŸç†ï¼Œä¹Ÿèƒ½åœ¨å®é™…å·¥ä½œä¸­ä½¿ç”¨æ—¶ï¼Œæ›´æ¸…æ¥šä¸ºä»€ä¹ˆè¦è¿™ä¹ˆä½¿ç”¨</p></li></ul></div><div class="links-wrapper"><div class="prev-link"><!----></div><div class="next-link"><!----></div></div><div><footer class="page-edit"><!--[--><a href="https://juejin.cn/user/465848663286712"><img class="imgIcon" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC"></a><a href="https://www.yuque.com/shouhu-pelkv"><img class="imgIcon" src="/blog/_assets/yuque.2a316201.png"></a><!--]--></footer><p class="platform"> ä»¥ä¸Šçš†ä¸º <a href="javascript:;">ç˜¦è™</a> æ–‡ç« å‘å¸ƒå¹³å° </p><p class="platform"> Copyright Â© 2020-2021 <a href="https://github.com/gelxgx">@Gelxgx</a></p></div><!--[--><!--]--></div><!-- åªæƒ³ç‚¹å‡»èƒŒæ™¯æ‰å…³é—­ è¯·ä½¿ç”¨ .self ä¿®é¥°ç¬¦ --><div style="display:none;" class="imgBox"><img src=""></div><!--]--></main><div class="theme-select" data-v-1eb0b654><ul data-v-1eb0b654><li class="active" data-v-1eb0b654>â˜€ï¸</li><li class="" data-v-1eb0b654>ğŸŒ‘</li></ul></div></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"README.md\":\"56ed425b\",\"index.md\":\"1783787d\",\"more_Friendship.md\":\"0d404086\",\"more_docs.md\":\"c4c7f0eb\",\"more_index.md\":\"350c9b6f\",\"more_tags.md\":\"36c4af96\",\"docs_HTTP_HTTP.md\":\"a018e2b2\",\"docs_React_react.md\":\"3700d50c\",\"docs_TypeScript_ts-class-function.md\":\"47de5c14\",\"docs_TypeScript_ts-type-interface.md\":\"4b859e67\",\"docs_arithmetic_arithmetic.md\":\"c0bf1668\",\"docs_soundCode_co.md\":\"17fa0c9b\",\"docs_soundCode_creat-vue.md\":\"782b5c9a\",\"docs_soundCode_koa-compose.md\":\"f6f000ab\",\"docs_soundCode_mitt-tiny-emitter.md\":\"764ec47d\",\"docs_soundCode_update-notifier.md\":\"342ac959\",\"docs_soundCode_validate-npm-package-name.md\":\"b739095c\",\"docs_soundCode_vite.md\":\"947ae370\",\"docs_soundCode_vue20tools.md\":\"8cbc77c4\",\"docs_soundCode_vueDevTools.md\":\"ec3412ef\"}")</script>
    <script type="module" async src="/blog/_assets/app.9e239910.js"></script>
  </body>
</html>